# 阿里巴巴Java开发规范检查规则

## 命名规范
- 类名使用UpperCamelCase风格，必须遵从驼峰形式
- 方法名、参数名、成员变量、局部变量都统一使用lowerCamelCase风格
- 常量命名全部大写，单词间用下划线隔开，力求语义表达完整清楚
- 包名统一使用小写，点分隔符之间有且仅有一个自然语义的英语单词
- 抽象类命名使用Abstract或Base开头；异常类命名使用Exception结尾；测试类命名以它要测试的类的名称开始，以Test结尾

## 代码格式
- 大括号的使用约定：左大括号前不换行，左大括号后换行；右大括号前换行，右大括号后还有else等代码则不换行
- 左小括号和字符之间不出现空格；同样，右小括号和字符之间也不出现空格
- if/for/while/switch/do等保留字与括号之间都必须加空格
- 任何二目、三目运算符的左右两边都需要加一个空格
- 采用4个空格缩进，禁止使用tab字符

## OOP规约
- 避免通过一个类的对象引用访问此类的静态变量或静态方法，无谓增加编译器解析成本，直接用类名来访问即可
- 所有的覆写方法，必须加@Override注解
- 相同参数类型，相同业务含义，才可以使用Java的可变参数，避免使用Object
- 外部正在调用或者二方库依赖的接口，不允许修改方法签名，避免对接口调用方产生影响
- 不能使用过时的类或方法

## 集合处理
- 关于hashCode和equals的处理，遵循如下规则：只要重写equals，就必须重写hashCode
- ArrayList的subList结果不可强转成ArrayList，否则会抛出ClassCastException异常
- 在subList场景中，高度注意对原集合元素个数的修改，会导致子列表的遍历、增加、删除均会产生ConcurrentModificationException异常
- 使用集合转数组的方法，必须使用集合的toArray(T[] array)，传入的是类型完全一样的数组，大小就是list.size()

## 并发处理
- 获取单例对象需要保证线程安全，其中的方法也要保证线程安全
- 创建线程或线程池时请指定有意义的线程名称，方便出错时回溯
- 线程资源必须通过线程池提供，不允许在应用中自行显式创建线程
- 线程池不允许使用Executors去创建，而是通过ThreadPoolExecutor的方式，这样的处理方式让写的同学更加明确线程池的运行规则，规避资源耗尽的风险

## 控制语句
- 在一个switch块内，每个case要么通过break/return等来终止，要么注释说明程序将继续执行到哪一个case为止
- 在if/else/for/while/do语句中必须使用大括号，即使只有一行代码
- 推荐尽量少用else，if-else的方式可以改写成：if(condition) { ... return obj; } // 接着写else的业务逻辑代码

## 注释规约
- 类、类属性、类方法的注释必须使用Javadoc规范，使用/**内容*/格式，不得使用//xxx方式
- 所有的抽象方法（包括接口中的方法）必须要用Javadoc注释、除了返回值、参数、异常说明外，还必须指出该方法做什么事情，实现什么功能
- 所有的类都必须添加创建者和创建日期
- 方法内部单行注释，在被注释语句上方另起一行，使用//注释。方法内部多行注释使用/* */注释，注意与代码对齐

## 异常处理
- Java类库中定义的可以通过预检查方式规避的RuntimeException异常不应该通过catch的方式来处理
- 异常不要用来做流程控制，条件控制
- catch时请分清稳定代码和非稳定代码，稳定代码指的是无论如何不会出错的代码。对于非稳定代码的catch尽可能进行区分异常类型，再做对应的异常处理
- 捕获异常是为了处理它，不要捕获了却什么都不处理而抛弃之，如果不想处理它，请将该异常抛给它的调用者

## 日志规约
- 应用中不可直接使用日志系统（Log4j、Logback）中的API，而应依赖使用日志框架SLF4J中的API，使用门面模式的日志框架，有利于维护和各个类的日志处理方式统一
- 对trace/debug/info级别的日志输出，必须使用条件输出形式或者使用占位符的方式
- 避免重复打印日志，浪费磁盘空间，务必在log4j.xml中设置additivity=false

## MySQL数据库规约
- 表达是与否概念的字段，必须使用is_xxx的方式命名，数据类型是unsigned tinyint（1表示是，0表示否）
- 表名、字段名必须使用小写字母或数字，禁止出现数字开头，禁止两个下划线中间只出现数字
- 表名不使用复数名词
- 禁用保留字，如desc、range、match、delayed等，请参考MySQL官方保留字
- 主键索引名为pk_字段名；唯一索引名为uk_字段名；普通索引名则为idx_字段名

## 工程结构
- 应用分层：开放接口层、终端显示层、Web层、Service层、Manager层、DAO层、外部接口或第三方平台、数据库
- 二方库依赖：定义GAV遵从以下规则：GroupID格式：com.{公司/BU}.业务线.[子业务线]，最多4级
- 服务器环境：给JVM设置-XX:+HeapDumpOnOutOfMemoryError参数，让JVM碰到OOM场景时输出dump信息